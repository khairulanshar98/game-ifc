(self.webpackChunkgame=self.webpackChunkgame||[]).push([[183],{3674:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ne}});var i=n(2791),r=n(5953),a=n(1507),o=n(6e3),c=n(4871),l=n(23),s=n(1889),d=n(7205),u=n(9439),h=n(232),f=n(7827),m=function(e){var t=(0,h.qp)(),n=(0,u.Z)(t,2),r=n[0],a=n[1],o=i.useRef(null),c=i.useState(void 0),l=(0,u.Z)(c,2),s=l[0],d=l[1],m=i.useState(null),v=(0,u.Z)(m,2),x=v[0],g=v[1],p=i.useState(null),Z=(0,u.Z)(p,2),j=Z[0],S=Z[1],w=i.useState(r.theme),M=(0,u.Z)(w,2),b=M[0],C=M[1];i.useEffect((function(){b&&a({type:f.U.SET_THEME,data:{theme:b}})}),[a,b]);return{store:r,toggleColorMode:function(){C((function(e){return"light"===e?"dark":"light"}))},mode:b,fileInput:o,onFileChange:function(){if(o.current.files&&o.current.files[0])if(o.current.files[0].size<=5242880){var e=URL.createObjectURL(o.current.files[0]);g(e),S(o.current.files[0].name)}else d("File size is too big. Please select file with size <= 5 MB")},handleClickOpen:function(){var e;d(void 0),null===o||void 0===o||null===(e=o.current)||void 0===e||e.click()},error:s,filePath:x,fileName:j}},v=n(4942),x=n(9367),g="".concat("MicroGame_root","_home"),p={root:"".concat(g,"-root"),group:"".concat(g,"-group"),label:"".concat(g,"-label"),file:"".concat(g,"-file")},Z=(0,x.ZP)("section")((function(e){var t,n=e.theme;return t={},(0,v.Z)(t,"&.".concat(p.root),{width:"100%",padding:n.spacing(2),margin:0}),(0,v.Z)(t,"& .".concat(p.group),{padding:0,margin:0}),(0,v.Z)(t,"& .".concat(p.label),{display:"flex",marginLeft:n.spacing(1),"& strong":{marginRight:n.spacing(1)}}),(0,v.Z)(t,"& .".concat(p.file),{visibility:"hidden",width:"0px",display:"inline-block"}),t})),j=n(5671),S=n(3144),w=n(136),M=n(7277),b={root:"".concat("Fallback","-root")},C=(0,x.ZP)("div")((function(e){var t=e.theme;return(0,v.Z)({},"&.".concat(b.root),{width:"100%",padding:t.spacing(2)})})),I=function(e){var t=i.useState(),n=(0,u.Z)(t,2),r=n[0],a=n[1],o=i.useState(),c=(0,u.Z)(o,2),l=c[0],s=c[1],d=i.useState(),h=(0,u.Z)(d,2),f=h[0],m=h[1];return i.useEffect((function(){e.error&&(s(e.error.message),a(e.error.name),m(e.error.stack))}),[e.error]),{errorMessage:l,errorName:r,errorStack:f}},P=n(184),k=function(e){var t=I(e),n=t.errorMessage,i=t.errorName,r=t.errorStack;return(0,P.jsxs)(C,{className:b.root,"data-testid":"FallbackError__page-id",children:[(0,P.jsx)("div",{children:(0,P.jsx)("strong",{children:i})}),(0,P.jsx)("div",{children:n}),(0,P.jsx)("div",{children:r})]})},y=function(e){(0,w.Z)(n,e);var t=(0,M.Z)(n);function n(e){var i;return(0,j.Z)(this,n),(i=t.call(this,e)).state={hasError:!1,error:void 0},i.state={hasError:!1},i}return(0,S.Z)(n,[{key:"render",value:function(){return this.state.hasError?(0,P.jsx)(k,{error:this.state.error}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,error:e}}}]),n}(i.Component),F=function(e){return(0,P.jsx)(y,{children:e.children})},N="".concat("MicroGame_root","_canvas"),E={root:"".concat(N,"-root"),info:"".concat(N,"-info"),action:"".concat(N,"-action")},D=(0,x.ZP)("section")((function(e){var t;e.theme;return t={},(0,v.Z)(t,"&.".concat(E.root),{width:"100%",padding:0,margin:0,"& canvas":{width:"100% !important",height:"calc(100vh - 88px) !important",outline:"none !important"}}),(0,v.Z)(t,"& .".concat(E.info),{height:"65px"}),(0,v.Z)(t,"& .".concat(E.action),{height:"65px"}),t})),_=n(4165),z=n(5861),L=n(1413),R=n(3433),G=n(7760),T=n(414);window.highlightMaterial=new T.Y({transparent:!0,opacity:.6,color:16746751,depthTest:!1});var H=function(e){var t=i.useState([]),n=(0,u.Z)(t,2),r=n[0],a=n[1],o=i.useState(),c=(0,u.Z)(o,2),l=c[0],s=c[1],d=i.useState([]),h=(0,u.Z)(d,2),f=h[0],m=h[1],v=i.useRef(null),x=i.useState(),g=(0,u.Z)(x,2),p=g[0],Z=g[1],j=i.useState(),S=(0,u.Z)(j,2),w=S[0],M=S[1],b=i.useState(),C=(0,u.Z)(b,2),I=C[0],P=C[1],k=i.useState(),y=(0,u.Z)(k,2),F=y[0],N=y[1],E=i.useState(),D=(0,u.Z)(E,2),H=D[0],O=D[1],U=i.useState(),X=(0,u.Z)(U,2),W=X[0],B=X[1],Y=i.useState(),q=(0,u.Z)(Y,2),A=q[0],V=q[1];i.useEffect((function(){if(e.filePath){var t=[].concat((0,R.Z)(f),[(0,L.Z)({},e)]);m(t)}}),[e.filePath]);var J=function(){var e=(0,z.Z)((0,_.Z)().mark((function e(t){var n;return(0,_.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Z(t),void 0!==window.manager&&void 0!==A&&void 0!==H&&void 0!==W&&(window.manager.removeSubset(H,window.highlightMaterial),n=new T.Y({transparent:!1,opacity:1,color:16777215+t.value,depthTest:!1,depthWrite:!1,alphaTest:1,side:G.FrontSide}),window.manager.createSubset({modelID:H,ids:[W],material:n,scene:A,removePrevious:!0}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{CanvasRef:v,selectedGeometry:I,selectedMaterial:w,selectedFaceIndex:F,selectedModelID:H,setSelectedMaterial:M,setSelectedGeometry:P,setSelectedFaceIndex:N,setSelectedModelID:O,setScene:V,setSelectedId:B,setIfcModels:a,move:function(e,t){if(l&&A){var n=A.children.findIndex((function(e){return e.uuid===l})),i=A.children[n];i.position.setX(i.position.x+e),i.position.setZ(i.position.z+t)}},filePaths:f,color:p,changeColor:J,handleChange:function(e){s(e.target.value)},ifcModels:r,selectedIfcModels:l}},O=n(5477),U=n(7412),X=n(6381),W=n(6267),B=function(e){var t=e.filePath,n=e.fileName,r=e.setSelectedMaterial,a=e.setSelectedGeometry,o=e.setSelectedFaceIndex,c=e.setSelectedModelID,l=e.setIfcModels,s=e.setScene,d=e.setSelectedId,u=(0,U.y)((function(e){return e.scene})),h=(0,i.useRef)(-1),f=(0,i.useRef)(null);(0,O.o)(f);var m=(0,U.C)(X.F,t,(function(e){window.manager&&window.manager.removeSubset(h.current,window.highlightMaterial),window.ifcLoader=e;var t=window.ifcLoader.ifcManager;t.setWasmPath("/"),window.manager=t,window.manager.setupThreeMeshBVH(W.Xy,W.sn,W.uL)}));function v(){return(v=(0,z.Z)((0,_.Z)().mark((function e(t){var n,i,l,s,f;return(0,_.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.faceIndex,i=t.object,l=i.modelID,s=i.geometry,f=window.manager.getExpressId(s,n||1),h.current=l,a(s),o(n),c(l),r(l),d(f),window.manager.createSubset({modelID:l,ids:[f],material:window.highlightMaterial,scene:u,removePrevious:!0});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return i.useEffect((function(){s(u),l((function(e){return[].concat((0,R.Z)(e),[(0,L.Z)((0,L.Z)({},m),{},{filePath:t,fileName:n})])}))}),[]),{mesh:f,ifc:m,handleDblClick:function(e){window.manager.removeSubset(h.current,window.highlightMaterial),function(e){v.apply(this,arguments)}(e)}}};function Y(e){var t=B(e),n=t.mesh,i=t.ifc,r=t.handleDblClick;return(0,P.jsx)("primitive",{ref:n,object:i,onDoubleClick:r})}var q=n(3520),A=n(5892),V=n(5042),J=n(9365),K=n(9407),Q=n(1898),$=n(1525),ee=.1,te=function(e){var t=H(e),n=t.CanvasRef,a=t.selectedGeometry,o=t.selectedMaterial,c=(t.selectedFaceIndex,t.selectedModelID,t.setSelectedMaterial),l=t.setSelectedGeometry,s=t.setSelectedFaceIndex,d=t.setSelectedModelID,u=t.setScene,h=t.setSelectedId,f=t.setIfcModels,m=t.move,v=t.filePaths,x=t.color,g=t.changeColor,p=t.handleChange,Z=t.ifcModels,j=t.selectedIfcModels;return(0,P.jsx)(F,{children:(0,P.jsxs)(D,{className:E.root,"data-testid":"Canvas__page-id",children:[(0,P.jsxs)(r.ZP,{container:!0,spacing:2,className:E.info,children:[(0,P.jsx)(r.ZP,{item:!0,xs:3,hidden:!a,children:(0,P.jsx)(V.zH,{value:"#".concat((null===x||void 0===x?void 0:x.hex)||"FFFFFF"),onChange:function(e){g(e)},disableTextfield:!0,disableAlpha:!0})}),(0,P.jsxs)(r.ZP,{item:!0,xs:3,children:[(0,P.jsx)("div",{children:"Selected Geometry"}),(0,P.jsx)("div",{children:null===a||void 0===a?void 0:a.uuid})]}),(0,P.jsxs)(r.ZP,{item:!0,xs:3,children:[(0,P.jsx)("div",{children:"Selected Material Color"}),(0,P.jsx)("div",{children:null===o||void 0===o?void 0:o.uuid})]})]}),(0,P.jsxs)(r.ZP,{container:!0,spacing:2,className:E.info,children:[(0,P.jsx)(r.ZP,{item:!0,xs:3,hidden:!Z.length,children:(0,P.jsxs)(Q.Z,{variant:"standard",sx:{m:1,minWidth:200},children:[(0,P.jsx)(J.Z,{children:"IFC Model"}),(0,P.jsxs)($.Z,{label:"IFC Model",value:j||"",onChange:p,children:[(0,P.jsx)(K.Z,{value:"",children:(0,P.jsx)("em",{children:"None"})}),Z&&Z.length&&Z.map((function(e){return(0,P.jsx)(K.Z,{value:e.uuid,children:e.fileName},e.uuid)}))]})]})}),(0,P.jsxs)(r.ZP,{item:!0,xs:7,hidden:!j,children:[(0,P.jsx)("button",{onClick:function(){m(ee,0)},children:"move x + 1"}),(0,P.jsx)("button",{onClick:function(){m(-.1,0)},children:"move x - 1"}),(0,P.jsx)("button",{onClick:function(){m(0,ee)},children:"move z + 1"}),(0,P.jsx)("button",{onClick:function(){m(0,-.1)},children:"move z - 1"})]})]}),(0,P.jsxs)(A.Xz,{ref:n,camera:{far:500,near:1,zoom:1,position:[1,8,20],rotation:[-.4,.55,.2]},children:[(0,P.jsx)("ambientLight",{intensity:.1,color:"white"}),(0,P.jsx)("directionalLight",{color:"white",position:[40,40,100]}),(0,P.jsx)("gridHelper",{args:[100,100]}),v&&v.length&&v.map((function(e){return(0,P.jsx)(i.Suspense,{fallback:null,children:(0,P.jsx)(Y,{filePath:e.filePath,setSelectedMaterial:c,setSelectedGeometry:l,setSelectedFaceIndex:s,setSelectedModelID:d,setScene:u,setSelectedId:h,setIfcModels:f,fileName:e.fileName})},e.filePath)})),(0,P.jsx)("axesHelper",{args:[20]}),(0,P.jsx)(q.z,{enablePan:!0,enableZoom:!0,enableRotate:!0})]})]})})},ne=function(e){var t,n,i,u=m(e),h=u.store,f=u.toggleColorMode,v=u.mode,x=u.fileInput,g=u.handleClickOpen,j=u.onFileChange,S=u.filePath,w=u.fileName;return(0,P.jsx)(F,{children:(0,P.jsxs)(Z,{className:p.root,"data-testid":"Home__page-id",children:[(0,P.jsxs)(c.Z,{children:[(0,P.jsx)("input",{className:p.file,ref:x,id:"file-input",type:"file",onChange:j,accept:".ifc, .ifcXML, .ifcZIP"}),(0,P.jsxs)(r.ZP,{container:!0,spacing:0,children:[(0,P.jsx)(r.ZP,{item:!0,xs:6,children:(0,P.jsx)(l.Z,{className:p.group,control:(0,P.jsx)(s.Z,{"data-testid":"Home__switch-id",checked:"light"===v,onChange:f}),label:(0,P.jsxs)("span",{className:p.label,children:[(0,P.jsx)("strong",{children:h.theme}),"light"===v?(0,P.jsx)(o.Z,{}):(0,P.jsx)(a.Z,{})]})})}),(0,P.jsx)(r.ZP,{item:!0,xs:6,children:(0,P.jsx)(l.Z,{control:(0,P.jsx)(d.Z,{size:"small",variant:"contained",color:"secondary",onClick:function(e){return g()},children:"Select IFC File"}),label:(0,P.jsx)("span",{className:p.label,children:(null===x||void 0===x||null===(t=x.current)||void 0===t?void 0:t.files)&&(null===x||void 0===x||null===(n=x.current)||void 0===n?void 0:n.files[0])&&(null===x||void 0===x||null===(i=x.current)||void 0===i?void 0:i.files[0].name)})})})]})]}),(0,P.jsx)(te,{filePath:S,fileName:w})]})})}},5226:function(e){function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=5226,e.exports=t}}]);
//# sourceMappingURL=183.61792273.chunk.js.map